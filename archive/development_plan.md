# 애니메이션 메타데이터 자동화 개발 계획

## 🎯 최종 목표
CSV 파일의 애니메이션 제목 → 라프텔 API 조회 → 노션 데이터베이스 자동 입력

## 📋 수집할 필드 (8개)
1. **`name`** - 애니메이션 제목
2. **`air_year_quarter`** - 방영분기  
3. **`avg_rating`** - 라프텔 평점
4. **`ended`** - 상태 (완결/방영중)
5. **`url`** - 라프텔 URL
6. **`image`** - 커버 URL
7. **`production`** - 제작사
8. **`total_episodes`** - 총 화수

---

## 🛠️ 개발 단계

### ✅ 1단계: A단계 스크립트 완성
- [x] ~~라프텔 API 버그 해결~~ (getAnimeInfo 사용)
- [ ] 필수 8개 필드로 스크립트 업데이트
- [ ] 총 화수 수집 로직 추가 (searchEpisodes)
- [ ] 수정된 스크립트 재테스트

**파일**: `step_a_laftel_test.py`

### 🔲 2단계: B단계 노션 연동
- [ ] 노션 API 토큰 설정 (.env 파일)
- [ ] 노션 데이터베이스 구조 확인
- [ ] 8개 필드에 맞는 노션 속성 생성
- [ ] 노션 업로드 스크립트 작성
- [ ] 노션 연동 테스트

**파일**: `step_b_notion_upload.py`

### 🔲 3단계: 통합 테스트
- [ ] A→B 단계 연결 테스트
- [ ] 다양한 애니메이션으로 전체 플로우 검증
- [ ] 에러 처리 강화
- [ ] 사용자 가이드 문서 작성

### 🔲 4단계: 배포 및 최적화
- [ ] 단일 실행 스크립트 통합
- [ ] 배치 처리 기능 (여러 작품 동시 처리)
- [ ] 중복 방지 로직
- [ ] 성능 최적화

---

## 📝 진행 상황 로그

### 2025-01-XX
- [x] 라프텔 라이브러리 버그 분석 완료
- [x] `laftel.sync.getAnimeInfo()` 해결책 발견
- [x] 에피소드 정보 수집 방법 확인
- [x] 최종 필드 요구사항 확정

### 2025-01-XX (오늘)
- [ ] A단계 스크립트 8개 필드로 업데이트
- [ ] 새로운 테스트 데이터로 검증

---

## 🔧 기술적 이슈 해결

### ✅ 해결완료
1. **라프텔 `get_data()` 버그**: `laftel.sync.getAnimeInfo(id)` 사용으로 해결
2. **에피소드 정보 부재**: `laftel.sync.searchEpisodes(id)` 사용으로 해결

### 🔍 현재 이슈
- 없음

---

## 📂 파일 구조
```
애니메이션 메타데이터 자동 입력/
├── anime.csv                    # 입력 파일
├── step_a_laftel_test.py       # A단계: 라프텔 API 테스트
├── step_b_notion_upload.py     # B단계: 노션 업로드
├── anime_laftel_output.csv     # A단계 출력 (B단계 입력)
├── .env                        # 환경변수 (노션 토큰 등)
└── development_plan.md         # 이 파일
```
